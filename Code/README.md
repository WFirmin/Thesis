This is the (somewhat unorganized) code that I used in my thesis.  To be organized and described at a later date.
